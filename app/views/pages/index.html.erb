<% @page_title = "Pages List" %>

<div class="container clearfix">
	<div class="row">
	  <div class="col-md-12">
			<div class="panel panel-default">
				<div class="panel-heading">
					<% if @all_pages %>
						<h2>All Pages</h2>
					<% else %>
						<h2><%= @subject.name %></h2>
					<% end %>
				</div><!-- End Panel-Heading -->
				<div class="panel-body">
					<%= link_to("<< Back to Vehicles", {:controller => 'subjects', 
								:action => 'index'}, :class => 'btn btn-default btn-sm pull-left') %>
					<%= link_to({:action => 'new', :subject_id => @subject.id}, :class => 'btn btn-success btn-sm pull-right', :data => {:title => 'Show', :toggle => 'modal', :target => '#new', :placement => 'top'}, :rel => 'tooltip') do %>
								<span class="glyphicon glyphicon-file"></span> New Page
						<% end %>
						<!-- Search Form -->
						<div class="col-md-4 pull-right input-group" style="margin-right: 60px;">
						 	<%= form_for(:sections, :url => {:controller => 'sections', :action => 'index'}, :method => 'get') do %>
							    <%= text_field_tag :search, params[:search], :class => 'form-control'%>
							   <span class="input-group-btn">
							  	<%= button_tag(type: 'submit', class: 'btn btn-default', name: nil) do %>
									 <span class="glyphicon glyphicon-search"></span>
									 <% end %>
									</span>
							<% end %>
						</div><!-- End Search  -->
				</div><!-- End Panel-Body -->
		  	<div class="table-responsive">
					<table class ="table table-striped table-condensed" summary="Page list">
						<thead>
							<th>&nbsp;</th>
							<th>Parent Subject</th>
							<th>Page Name</th>
							<th>Child Sections</th>
							<th>Permalink</th>
							<th>Visible</th>
							<th></th>
						</thead>
						<tbody>
						<% @pages.each do |page| %>
						<tr>
							<td><%= page.position %></td>
							<td><%= page.subject.name if page.subject %></td>
							<td><%= page.name %></td>
							<td class="center"><%= page.sections.size %></td>
							<td class="center"><%= page.permalink %></td>
							<td class="center"><%= status_tag(page.visible) %></td>
							<td style="text-align: center;">
									<div class="btn-group">
								<%= link_to("View Sections", {:controller => 'sections', 
									:page_id => page.id}, :class => 'btn btn-primary btn-xs') %>
									<button type="button" class="btn btn-primary btn-xs dropdown-toggle" data-toggle="dropdown">
								      <span class="glyphicon glyphicon-cog"></span><span class="caret"></span>
								    </button>
								    <ul class="dropdown-menu" role="menu">
											<li class="dropdown-header"><%= page.name %></li>
											<li><%= link_to("Show", {:action => 'show', :id => page.id, :subject_id => @subject.id}, :class => '', :data => {:title => 'Show', :toggle => 'modal', :target => '#show', :placement => 'top'}, :rel => 'tooltip') %>
											</li>
											<li><%= link_to("Edit", {:action => 'edit', :id => page.id, 
												:subject_id => @subject.id}, :class => '', :data => {:title => 'Show', :toggle => 'modal', :target => '#edit', :placement => 'top'}, :rel => 'tooltip') %>
											</li>
											<li><%= link_to("Delete", {:action => 'delete', :id => page.id, :subject_id => @subject.id}, :class => '', :data => {:title => 'Show', :toggle => 'modal', :target => '#delete', :placement => 'top'}, :rel => 'tooltip') %>
											</li>
										</ul>
									</div>
							</td>
						</tr>
						<% end %>
					</tbody>
					</table>
				</div><!-- End Table-Responsive -->
				<div class="panel-footer">
					<p><%= pluralize(@pages.size, 'page') %> found</p>
					<div class="pull-right">
						<%= will_paginate @collection, renderer: BootstrapPagination::Rails, :previous_label => '<span class="glyphicon glyphicon-chevron-left"></span>', :next_label => '<span class="glyphicon glyphicon-chevron-right"></span>' %>
					</div><!-- End Pagination -->
				</div><!-- End Panel-Footer -->
			</div><!-- End Panel -->
		</div><!-- End Col -->
	</div><!-- End Row -->
</div><!-- End Container -->

<%= render(:partial => 'layouts/modal_containers') %>
